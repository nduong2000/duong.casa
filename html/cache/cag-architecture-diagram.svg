<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <!-- Background with subtle grid -->
  <rect width="1200" height="800" fill="#f8f9fa" rx="10" ry="10" />
  <pattern id="smallGrid" width="10" height="10" patternUnits="userSpaceOnUse">
    <path d="M 10 0 L 0 0 0 10" fill="none" stroke="#f0f0f0" stroke-width="0.5"/>
  </pattern>
  <rect width="1200" height="800" fill="url(#smallGrid)" />
  
  <!-- Title and Subtitle -->
  <text x="600" y="50" font-family="Arial" font-size="32" font-weight="bold" text-anchor="middle">Cache Augmented Generation (CAG) System</text>
  <text x="600" y="85" font-family="Arial" font-size="16" text-anchor="middle" fill="#666">Architecture Overview</text>
  
  <!-- Main Sections -->
  <!-- User Interface Layer -->
  <rect x="100" y="120" width="1000" height="110" rx="8" ry="8" fill="#e8eaf6" stroke="#3949ab" stroke-width="2" />
  <text x="140" y="145" font-family="Arial" font-size="20" font-weight="bold" fill="#3949ab">User Interface Layer</text>
  
  <!-- Web Interface Box -->
  <rect x="150" y="160" width="250" height="55" rx="6" ry="6" fill="#c5cae9" stroke="#3949ab" stroke-width="1.5" />
  <text x="275" y="193" font-family="Arial" font-size="18" text-anchor="middle">Web Interface</text>
  
  <!-- HTTP Request/Response Box -->
  <rect x="470" y="160" width="250" height="55" rx="6" ry="6" fill="#c5cae9" stroke="#3949ab" stroke-width="1.5" />
  <text x="595" y="193" font-family="Arial" font-size="18" text-anchor="middle">HTTP Request/Response</text>
  
  <!-- Visualization Box -->
  <rect x="790" y="160" width="250" height="55" rx="6" ry="6" fill="#c5cae9" stroke="#3949ab" stroke-width="1.5" />
  <text x="915" y="193" font-family="Arial" font-size="18" text-anchor="middle">Response Visualization</text>

  <!-- API Server Layer -->
  <rect x="100" y="250" width="1000" height="180" rx="8" ry="8" fill="#e0f2f1" stroke="#00796b" stroke-width="2" />
  <text x="140" y="275" font-family="Arial" font-size="20" font-weight="bold" fill="#00796b">API Server Layer (Flask)</text>
  
  <!-- API Endpoints -->
  <rect x="140" y="290" width="300" height="120" rx="6" ry="6" fill="#b2dfdb" stroke="#00796b" stroke-width="1.5" />
  <text x="290" y="315" font-family="Arial" font-size="18" text-anchor="middle">API Endpoints</text>
  <text x="170" y="345" font-family="Arial" font-size="14">/query - Document queries</text>
  <text x="170" y="370" font-family="Arial" font-size="14">/preload - Topic preloading</text>
  <text x="170" y="395" font-family="Arial" font-size="14">/cache - Cache management</text>
  
  <!-- Query Processing -->
  <rect x="460" y="290" width="300" height="120" rx="6" ry="6" fill="#b2dfdb" stroke="#00796b" stroke-width="1.5" />
  <text x="610" y="315" font-family="Arial" font-size="18" text-anchor="middle">Query Processing</text>
  <text x="490" y="345" font-family="Arial" font-size="14">- Parameter extraction</text>
  <text x="490" y="370" font-family="Arial" font-size="14">- Query transformation</text>
  <text x="490" y="395" font-family="Arial" font-size="14">- Response formatting</text>
  
  <!-- CORS & Error Handling -->
  <rect x="780" y="290" width="300" height="120" rx="6" ry="6" fill="#b2dfdb" stroke="#00796b" stroke-width="1.5" />
  <text x="930" y="315" font-family="Arial" font-size="18" text-anchor="middle">System Management</text>
  <text x="810" y="345" font-family="Arial" font-size="14">- Error handling</text>
  <text x="810" y="370" font-family="Arial" font-size="14">- CORS support</text>
  <text x="810" y="395" font-family="Arial" font-size="14">- Monitoring & logging</text>
  
  <!-- Cache Layer -->
  <rect x="100" y="450" width="1000" height="150" rx="8" ry="8" fill="#f9fbe7" stroke="#827717" stroke-width="2" />
  <text x="140" y="475" font-family="Arial" font-size="20" font-weight="bold" fill="#827717">Cache Layer</text>
  
  <!-- LRU Cache Box -->
  <rect x="140" y="490" width="225" height="95" rx="6" ry="6" fill="#f0f4c3" stroke="#827717" stroke-width="1.5" />
  <text x="252" y="515" font-family="Arial" font-size="18" text-anchor="middle">LRU Inference Cache</text>
  <text x="252" y="540" font-family="Arial" font-size="14" text-anchor="middle">Exact Query Matching</text>
  <text x="252" y="565" font-family="Arial" font-size="14" text-anchor="middle">Fast Response</text>
  
  <!-- Semantic Cache Box -->
  <rect x="385" y="490" width="225" height="95" rx="6" ry="6" fill="#f0f4c3" stroke="#827717" stroke-width="1.5" />
  <text x="497" y="515" font-family="Arial" font-size="18" text-anchor="middle">Preloaded Topics</text>
  <text x="497" y="540" font-family="Arial" font-size="14" text-anchor="middle">Semantic Matching</text>
  <text x="497" y="565" font-family="Arial" font-size="14" text-anchor="middle">Common Queries</text>
  
  <!-- Persistent Cache Box -->
  <rect x="630" y="490" width="225" height="95" rx="6" ry="6" fill="#f0f4c3" stroke="#827717" stroke-width="1.5" />
  <text x="742" y="515" font-family="Arial" font-size="18" text-anchor="middle">Persistent Storage</text>
  <text x="742" y="540" font-family="Arial" font-size="14" text-anchor="middle">File-based Caching</text>
  <text x="742" y="565" font-family="Arial" font-size="14" text-anchor="middle">Cross-session Retention</text>
  
  <!-- Cache Analytics Box -->
  <rect x="875" y="490" width="225" height="95" rx="6" ry="6" fill="#f0f4c3" stroke="#827717" stroke-width="1.5" />
  <text x="987" y="515" font-family="Arial" font-size="18" text-anchor="middle">Cache Analytics</text>
  <text x="987" y="540" font-family="Arial" font-size="14" text-anchor="middle">Performance Monitoring</text>
  <text x="987" y="565" font-family="Arial" font-size="14" text-anchor="middle">Cache Statistics</text>
  
  <!-- RAG System Layer -->
  <rect x="100" y="620" width="1000" height="110" rx="8" ry="8" fill="#fff3e0" stroke="#e65100" stroke-width="2" />
  <text x="140" y="645" font-family="Arial" font-size="20" font-weight="bold" fill="#e65100">RAG System Layer</text>
  
  <!-- LlamaIndex Box -->
  <rect x="150" y="660" width="220" height="55" rx="6" ry="6" fill="#ffe0b2" stroke="#e65100" stroke-width="1.5" />
  <text x="260" y="693" font-family="Arial" font-size="18" text-anchor="middle">LlamaIndex</text>
  
  <!-- Ollama LLM Box -->
  <rect x="390" y="660" width="220" height="55" rx="6" ry="6" fill="#ffe0b2" stroke="#e65100" stroke-width="1.5" />
  <text x="500" y="693" font-family="Arial" font-size="18" text-anchor="middle">Ollama (phi4:14b)</text>
  
  <!-- Embeddings Box -->
  <rect x="630" y="660" width="220" height="55" rx="6" ry="6" fill="#ffe0b2" stroke="#e65100" stroke-width="1.5" />
  <text x="740" y="693" font-family="Arial" font-size="18" text-anchor="middle">BGE-M3 Embeddings</text>
  
  <!-- Vector Storage Box -->
  <rect x="870" y="660" width="220" height="55" rx="6" ry="6" fill="#ffe0b2" stroke="#e65100" stroke-width="1.5" />
  <text x="980" y="693" font-family="Arial" font-size="18" text-anchor="middle">ChromaDB Vector Storage</text>
  
  <!-- Connection Lines -->
  <!-- UI to API -->
  <path d="M600 230 L600 250" stroke="#3949ab" stroke-width="2" marker-end="url(#arrowhead)" />
  
  <!-- API to Cache -->
  <path d="M600 430 L600 450" stroke="#00796b" stroke-width="2" marker-end="url(#arrowhead)" />
  
  <!-- Cache to RAG (Optional) -->
  <path d="M250 585 L250 620" stroke="#827717" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)" />
  <text x="265" y="605" font-family="Arial" font-size="12" fill="#666">Cache Miss</text>
  
  <!-- RAG to Cache (Update) -->
  <path d="M900 660 L900 585" stroke="#e65100" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)" />
  <text x="915" y="625" font-family="Arial" font-size="12" fill="#666">Cache Update</text>
  
  <!-- Cache Connections -->
  <path d="M365 540 L385 540" stroke="#827717" stroke-width="2" marker-end="url(#arrowhead)" />
  <path d="M610 540 L630 540" stroke="#827717" stroke-width="2" marker-end="url(#arrowhead)" />
  <path d="M855 540 L875 540" stroke="#827717" stroke-width="2" marker-end="url(#arrowhead)" />
  
  <!-- RAG Connections -->
  <path d="M370 685 L390 685" stroke="#e65100" stroke-width="2" marker-end="url(#arrowhead)" />
  <path d="M610 685 L630 685" stroke="#e65100" stroke-width="2" marker-end="url(#arrowhead)" />
  <path d="M850 685 L870 685" stroke="#e65100" stroke-width="2" marker-end="url(#arrowhead)" />
  
  <!-- Setup Process Component -->
  <rect x="62" y="137" width="25" height="580" rx="5" ry="5" fill="#f3e5f5" stroke="#8e24aa" stroke-width="1.5" />
  <text x="75" y="430" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" transform="rotate(270, 75, 430)">setup_cache.py</text>
  
  <!-- Setup connections -->
  <path d="M87 200 L140 200" stroke="#8e24aa" stroke-width="1.5" stroke-dasharray="3,3" marker-end="url(#arrowhead)" />
  <path d="M87 340 L140 340" stroke="#8e24aa" stroke-width="1.5" stroke-dasharray="3,3" marker-end="url(#arrowhead)" />
  <path d="M87 525 L140 525" stroke="#8e24aa" stroke-width="1.5" stroke-dasharray="3,3" marker-end="url(#arrowhead)" />
  <path d="M87 680 L150 680" stroke="#8e24aa" stroke-width="1.5" stroke-dasharray="3,3" marker-end="url(#arrowhead)" />
  
  <!-- Legend -->
  <rect x="250" y="750" width="700" height="30" rx="5" ry="5" fill="white" stroke="#666" stroke-width="1" />
  <text x="270" y="770" font-family="Arial" font-size="14" font-weight="bold">Legend:</text>
  
  <rect x="340" y="755" width="16" height="10" rx="2" ry="2" fill="#e8eaf6" stroke="#3949ab" stroke-width="1" />
  <text x="363" y="770" font-family="Arial" font-size="12">UI Layer</text>
  
  <rect x="425" y="755" width="16" height="10" rx="2" ry="2" fill="#e0f2f1" stroke="#00796b" stroke-width="1" />
  <text x="448" y="770" font-family="Arial" font-size="12">API Layer</text>
  
  <rect x="510" y="755" width="16" height="10" rx="2" ry="2" fill="#f9fbe7" stroke="#827717" stroke-width="1" />
  <text x="533" y="770" font-family="Arial" font-size="12">Cache Layer</text>
  
  <rect x="595" y="755" width="16" height="10" rx="2" ry="2" fill="#fff3e0" stroke="#e65100" stroke-width="1" />
  <text x="618" y="770" font-family="Arial" font-size="12">RAG Layer</text>
  
  <rect x="680" y="755" width="16" height="10" rx="2" ry="2" fill="#f3e5f5" stroke="#8e24aa" stroke-width="1" />
  <text x="703" y="770" font-family="Arial" font-size="12">Setup Process</text>
  
  <line x1="760" y1="765" x2="780" y2="765" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)" />
  <text x="800" y="770" font-family="Arial" font-size="12">Data Flow</text>
  
  <line x1="845" y1="765" x2="865" y2="765" stroke="#666" stroke-width="2" stroke-dasharray="3,3" />
  <text x="885" y="770" font-family="Arial" font-size="12">Optional Flow</text>
  
  <!-- Key Features -->
  <rect x="250" y="720" width="700" height="25" rx="5" ry="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1" />
  <text x="600" y="737" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#2e7d32">Key Features: Hybrid Retrieval, Semantic Matching, LRU Caching, Preloaded Topics, Persistent Storage</text>
  
  <!-- Version -->
  <text x="1160" y="790" font-family="Arial" font-size="12" text-anchor="end" fill="#666">v1.0</text>
  
  <!-- Markers for arrows -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666" />
    </marker>
  </defs>
</svg>